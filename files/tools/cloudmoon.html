<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Sandbox Redirect Instead of Popup</title>
<style>
  html, body {
    height: 100%;
    margin: 0;
    background: #0a0a0a;
    color: white;
    font-family: system-ui, sans-serif;
  }
  iframe {
    width: 100%;
    height: 100%;
    border: none;
    display: block;
  }
</style>
</head>
<body>
<iframe id="sandboxFrame" sandbox="allow-scripts allow-forms allow-same-origin" allow="fullscreen"></iframe>

<script>
const frame = document.getElementById('sandboxFrame');
const targetURL = "https://web.cloudmoonapp.com/";

// load the target URL through a blob with popup override
const injected = `
  <script>
    // Override window.open to redirect same frame
    window.open = function(url) {
      if (url) location.href = url;
      return null;
    };
    // Then load the real site
    location.href = "${targetURL}";
  <\/script>
`;

// create a blob that injects our override before loading site
const blob = new Blob([injected], { type: "text/html" });
const blobURL = URL.createObjectURL(blob);
frame.src = blobURL;
</script>
</body>
</html>
