<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>New Tab</title>

  <!-- UPDATED -->
  <link rel="manifest" href="https://ccsdut.github.io/Physics-Motion/install/manifest.json" />

  <style>
    html, body {
      margin: 0; padding: 0;
      height: 100%; width: 100%;
      overflow: hidden;
      background: black;
      font-family: sans-serif;
    }

    iframe {
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      border: none;
      background: black;
    }

    #menu-btn {
      position: fixed;
      top: 12px;
      left: 12px;
      z-index: 10000;
      background: none;
      border: none;
      padding: 0;
      cursor: pointer;
      transition: opacity 0.4s ease;
    }
    #menu-btn img {
      width: 60px;
      height: 60px;
    }

    #overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      z-index: 9998;
      display: none;
      transition: opacity 0.4s ease;
    }

    #menu-box {
      position: fixed;
      top: 80px;
      left: 12px;
      background: rgba(0,0,0,0.9);
      border-radius: 16px;
      padding: 12px;
      display: none;
      flex-direction: column;
      gap: 12px;
      width: max-content;
      z-index: 9999;
      border: 2px solid white;
      transition: opacity 0.4s ease;
    }

    .menu-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      background: rgba(255,255,255,0.1);
      border-radius: 10px;
      cursor: pointer;
      color: white;
      font-size: 14px;
      font-weight: bold;
      white-space: nowrap;
    }
    .menu-item:hover {
      background: rgba(255,255,255,0.2);
    }
    .menu-item img {
      width: 36px;
      height: 36px;
    }

    #google-overlay {
      position: fixed;
      inset: 0;
      border: none;
      z-index: 10004;
      background: white;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    #toggle-island {
      position: fixed;
      bottom: 12px;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 22px;
      background: rgba(255,255,255,0.05);
      backdrop-filter: blur(10px);
      border-radius: 11px;
      z-index: 10005;
      cursor: pointer;
      box-shadow: 0 1px 6px rgba(0,0,0,0.4);
      transition: all 0.3s ease;
      border: 1px solid rgba(255,255,255,0.05);
    }
    #toggle-island:hover {
      background: rgba(255,255,255,0.15);
    }
  </style>
</head>
<body>

  <!-- UPDATED IMAGE LINKS -->
  <button id="menu-btn">
    <img src="https://ccsdut.github.io/Physics-Motion/media/menu.png">
  </button>

  <div id="overlay"></div>

  <div id="menu-box">
    <div class="menu-item" onclick="goHome()">
      <img src="https://ccsdut.github.io/Physics-Motion/media/homeicon.png">
      Home
    </div>

    <div class="menu-item" onclick="toggleFullscreen()">
      <img src="https://ccsdut.github.io/Physics-Motion/media/fullscreen.png">
      Fullscreen
    </div>

    <div class="menu-item" onclick="removeMenu()">
      <img src="https://ccsdut.github.io/Physics-Motion/media/no-menu.png">
      Remove 3 Lines
    </div>

    <div class="menu-item" id="installBtn" style="display:none;">
      <img src="https://ccsdut.github.io/Physics-Motion/media/install.png">
      Install
    </div>
  </div>

  <!-- UPDATED IFRAME -->
  <iframe
    id="game-iframe"
    src="https://ccsdut.github.io/Physics-Motion/files/home.html"
    allow="autoplay; encrypted-media; pointer-lock">
  </iframe>

  <iframe
    id="google-overlay"
    src="https://www.google.com?igu=1">
  </iframe>

  <div id="toggle-island" onclick="toggleOverlay(!isOverlayVisible)"></div>

  <script>
    const menuBtn = document.getElementById('menu-btn');
    const menuBox = document.getElementById('menu-box');
    const overlay = document.getElementById('overlay');
    const iframe = document.getElementById('game-iframe');
    const googleOverlay = document.getElementById('google-overlay');

    let isOverlayVisible = false;

    function toggleOverlay(show) {
      googleOverlay.style.opacity = show ? '1' : '0';
      googleOverlay.style.pointerEvents = show ? 'auto' : 'none';
      isOverlayVisible = show;
      closeMenu();
    }

    menuBtn.onclick = () => {
      const open = menuBox.style.display === "flex";
      if (open) closeMenu();
      else {
        menuBox.style.display = "flex";
        overlay.style.display = "block";
        setTimeout(() => {
          menuBox.style.opacity = 1;
          overlay.style.opacity = 1;
        }, 10);
      }
    };

    overlay.onclick = closeMenu;

    function closeMenu() {
      menuBox.style.opacity = 0;
      overlay.style.opacity = 0;
      setTimeout(() => {
        menuBox.style.display = "none";
        overlay.style.display = "none";
      }, 400);
    }

    function goHome() {
      iframe.src = "https://ccsdut.github.io/Physics-Motion/files/home.html";
      closeMenu();
    }

    function toggleFullscreen() {
      const el = document.documentElement;
      closeMenu();
      if (!document.fullscreenElement) el.requestFullscreen();
      else document.exitFullscreen();
    }

    function removeMenu() {
      menuBtn.style.opacity = 0;
      menuBox.style.opacity = 0;
      overlay.style.opacity = 0;
      setTimeout(() => {
        menuBtn.remove();
        menuBox.remove();
        overlay.remove();
      }, 400);
    }

    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', e => {
      e.preventDefault();
      deferredPrompt = e;
      document.getElementById('installBtn').style.display = 'flex';
    });

    document.getElementById('installBtn').onclick = () => {
      deferredPrompt.prompt();
      deferredPrompt = null;
    };
  </script>
</body>
</html>
